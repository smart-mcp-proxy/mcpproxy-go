components:
  schemas:
    config.Config:
      type: object
    config.IsolationConfig:
      description: Per-server isolation settings
      properties:
        enabled:
          description: Enable Docker isolation for this server
          type: boolean
        extra_args:
          description: Additional docker run arguments for this server
          items:
            type: string
          type: array
          uniqueItems: false
        image:
          description: Custom Docker image (overrides default)
          type: string
        log_driver:
          description: Docker log driver override for this server
          type: string
        log_max_files:
          description: Maximum number of log files override
          type: string
        log_max_size:
          description: Maximum size of log files override
          type: string
        network_mode:
          description: Custom network mode for this server
          type: string
        working_dir:
          description: Custom working directory in container
          type: string
      type: object
    config.OAuthConfig:
      description: OAuth configuration (keep even when empty to signal OAuth requirement)
      properties:
        client_id:
          type: string
        client_secret:
          type: string
        extra_params:
          additionalProperties:
            type: string
          description: Additional OAuth parameters (e.g., RFC 8707 resource)
          type: object
        pkce_enabled:
          type: boolean
        redirect_uri:
          type: string
        scopes:
          items:
            type: string
          type: array
          uniqueItems: false
      type: object
    config.ServerConfig:
      properties:
        args:
          items:
            type: string
          type: array
          uniqueItems: false
        command:
          type: string
        created:
          type: string
        enabled:
          type: boolean
        env:
          additionalProperties:
            type: string
          type: object
        headers:
          additionalProperties:
            type: string
          description: For HTTP servers
          type: object
        isolation:
          $ref: '#/components/schemas/config.IsolationConfig'
        name:
          type: string
        oauth:
          $ref: '#/components/schemas/config.OAuthConfig'
        protocol:
          description: stdio, http, sse, streamable-http, auto
          type: string
        quarantined:
          description: Security quarantine status
          type: boolean
        updated:
          type: string
        url:
          type: string
        working_dir:
          description: Working directory for stdio servers
          type: string
      type: object
    contracts.ConfigApplyResult:
      properties:
        applied_immediately:
          type: boolean
        changed_fields:
          items:
            type: string
          type: array
          uniqueItems: false
        requires_restart:
          type: boolean
        restart_reason:
          type: string
        success:
          type: boolean
        validation_errors:
          items:
            $ref: '#/components/schemas/contracts.ValidationError'
          type: array
          uniqueItems: false
      type: object
    contracts.Diagnostics:
      properties:
        docker_status:
          $ref: '#/components/schemas/contracts.DockerStatus'
        missing_secrets:
          description: Renamed to avoid conflict
          items:
            $ref: '#/components/schemas/contracts.MissingSecretInfo'
          type: array
          uniqueItems: false
        oauth_issues:
          description: OAuth parameter mismatches
          items:
            $ref: '#/components/schemas/contracts.OAuthIssue'
          type: array
          uniqueItems: false
        oauth_required:
          items:
            $ref: '#/components/schemas/contracts.OAuthRequirement'
          type: array
          uniqueItems: false
        runtime_warnings:
          items:
            type: string
          type: array
          uniqueItems: false
        timestamp:
          type: string
        total_issues:
          type: integer
        upstream_errors:
          items:
            $ref: '#/components/schemas/contracts.UpstreamError'
          type: array
          uniqueItems: false
      type: object
    contracts.DockerStatus:
      properties:
        available:
          type: boolean
        error:
          type: string
        version:
          type: string
      type: object
    contracts.ErrorResponse:
      properties:
        error:
          type: string
        success:
          type: boolean
      type: object
    contracts.GetConfigResponse:
      properties:
        config:
          description: The configuration object
        config_path:
          description: Path to config file
          type: string
      type: object
    contracts.GetRegistriesResponse:
      properties:
        registries:
          items:
            $ref: '#/components/schemas/contracts.Registry'
          type: array
          uniqueItems: false
        total:
          type: integer
      type: object
    contracts.GetServerLogsResponse:
      properties:
        count:
          type: integer
        logs:
          items:
            $ref: '#/components/schemas/contracts.LogEntry'
          type: array
          uniqueItems: false
        server_name:
          type: string
      type: object
    contracts.GetServerToolCallsResponse:
      properties:
        server_name:
          type: string
        tool_calls:
          items:
            $ref: '#/components/schemas/contracts.ToolCallRecord'
          type: array
          uniqueItems: false
        total:
          type: integer
      type: object
    contracts.GetServerToolsResponse:
      properties:
        count:
          type: integer
        server_name:
          type: string
        tools:
          items:
            $ref: '#/components/schemas/contracts.Tool'
          type: array
          uniqueItems: false
      type: object
    contracts.GetServersResponse:
      properties:
        servers:
          items:
            $ref: '#/components/schemas/contracts.Server'
          type: array
          uniqueItems: false
        stats:
          $ref: '#/components/schemas/contracts.ServerStats'
      type: object
    contracts.GetSessionDetailResponse:
      properties:
        session:
          $ref: '#/components/schemas/contracts.MCPSession'
      type: object
    contracts.GetSessionsResponse:
      properties:
        limit:
          type: integer
        offset:
          type: integer
        sessions:
          items:
            $ref: '#/components/schemas/contracts.MCPSession'
          type: array
          uniqueItems: false
        total:
          type: integer
      type: object
    contracts.GetToolCallDetailResponse:
      properties:
        tool_call:
          $ref: '#/components/schemas/contracts.ToolCallRecord'
      type: object
    contracts.GetToolCallsResponse:
      properties:
        limit:
          type: integer
        offset:
          type: integer
        tool_calls:
          items:
            $ref: '#/components/schemas/contracts.ToolCallRecord'
          type: array
          uniqueItems: false
        total:
          type: integer
      type: object
    contracts.IsolationConfig:
      properties:
        cpu_limit:
          type: string
        enabled:
          type: boolean
        image:
          type: string
        memory_limit:
          type: string
        timeout:
          type: string
        working_dir:
          type: string
      type: object
    contracts.LogEntry:
      properties:
        fields:
          additionalProperties: {}
          type: object
        level:
          type: string
        message:
          type: string
        server:
          type: string
        timestamp:
          type: string
      type: object
    contracts.MCPSession:
      properties:
        client_name:
          type: string
        client_version:
          type: string
        end_time:
          type: string
        experimental:
          items:
            type: string
          type: array
          uniqueItems: false
        has_roots:
          description: MCP Client Capabilities
          type: boolean
        has_sampling:
          type: boolean
        id:
          type: string
        last_activity:
          type: string
        start_time:
          type: string
        status:
          type: string
        tool_call_count:
          type: integer
        total_tokens:
          type: integer
      type: object
    contracts.MissingSecretInfo:
      properties:
        secret_name:
          type: string
        used_by:
          items:
            type: string
          type: array
          uniqueItems: false
      type: object
    contracts.NPMPackageInfo:
      properties:
        exists:
          type: boolean
        install_cmd:
          type: string
      type: object
    contracts.OAuthConfig:
      properties:
        auth_url:
          type: string
        client_id:
          type: string
        extra_params:
          additionalProperties:
            type: string
          type: object
        pkce_enabled:
          type: boolean
        redirect_port:
          type: integer
        scopes:
          items:
            type: string
          type: array
          uniqueItems: false
        token_expires_at:
          description: When the OAuth token expires
          type: string
        token_url:
          type: string
        token_valid:
          description: Whether token is currently valid
          type: boolean
      type: object
    contracts.OAuthIssue:
      properties:
        documentation_url:
          type: string
        error:
          type: string
        issue:
          type: string
        missing_params:
          items:
            type: string
          type: array
          uniqueItems: false
        resolution:
          type: string
        server_name:
          type: string
      type: object
    contracts.OAuthRequirement:
      properties:
        expires_at:
          type: string
        message:
          type: string
        server_name:
          type: string
        state:
          type: string
      type: object
    contracts.Registry:
      properties:
        count:
          description: number or string
        description:
          type: string
        id:
          type: string
        name:
          type: string
        protocol:
          type: string
        servers_url:
          type: string
        tags:
          items:
            type: string
          type: array
          uniqueItems: false
        url:
          type: string
      type: object
    contracts.ReplayToolCallRequest:
      properties:
        arguments:
          additionalProperties: {}
          description: Modified arguments for replay
          type: object
      type: object
    contracts.ReplayToolCallResponse:
      properties:
        error:
          description: Error if replay failed
          type: string
        new_call_id:
          description: ID of the newly created call
          type: string
        new_tool_call:
          $ref: '#/components/schemas/contracts.ToolCallRecord'
        replayed_from:
          description: Original call ID
          type: string
        success:
          type: boolean
      type: object
    contracts.RepositoryInfo:
      description: Detected package info
      properties:
        npm:
          $ref: '#/components/schemas/contracts.NPMPackageInfo'
      type: object
    contracts.RepositoryServer:
      properties:
        connect_url:
          description: Alternative connection URL
          type: string
        created_at:
          type: string
        description:
          type: string
        id:
          type: string
        install_cmd:
          description: Installation command
          type: string
        name:
          type: string
        registry:
          description: Which registry this came from
          type: string
        repository_info:
          $ref: '#/components/schemas/contracts.RepositoryInfo'
        source_code_url:
          description: Source repository URL
          type: string
        updated_at:
          type: string
        url:
          description: MCP endpoint for remote servers only
          type: string
      type: object
    contracts.SearchRegistryServersResponse:
      properties:
        query:
          type: string
        registry_id:
          type: string
        servers:
          items:
            $ref: '#/components/schemas/contracts.RepositoryServer'
          type: array
          uniqueItems: false
        tag:
          type: string
        total:
          type: integer
      type: object
    contracts.SearchResult:
      properties:
        matches:
          type: integer
        score:
          type: number
        snippet:
          type: string
        tool:
          $ref: '#/components/schemas/contracts.Tool'
      type: object
    contracts.SearchToolsResponse:
      properties:
        query:
          type: string
        results:
          items:
            $ref: '#/components/schemas/contracts.SearchResult'
          type: array
          uniqueItems: false
        took:
          type: string
        total:
          type: integer
      type: object
    contracts.Server:
      properties:
        args:
          items:
            type: string
          type: array
          uniqueItems: false
        authenticated:
          description: OAuth authentication status
          type: boolean
        command:
          type: string
        connected:
          type: boolean
        connected_at:
          type: string
        created:
          type: string
        enabled:
          type: boolean
        env:
          additionalProperties:
            type: string
          type: object
        headers:
          additionalProperties:
            type: string
          type: object
        id:
          type: string
        isolation:
          $ref: '#/components/schemas/contracts.IsolationConfig'
        last_error:
          type: string
        last_reconnect_at:
          type: string
        last_retry_time:
          type: string
        name:
          type: string
        oauth:
          $ref: '#/components/schemas/contracts.OAuthConfig'
        protocol:
          type: string
        quarantined:
          type: boolean
        reconnect_count:
          type: integer
        retry_count:
          type: integer
        should_retry:
          type: boolean
        status:
          type: string
        tool_count:
          type: integer
        tool_list_token_size:
          description: Token size for this server's tools
          type: integer
        updated:
          type: string
        url:
          type: string
        working_dir:
          type: string
      type: object
    contracts.ServerActionResponse:
      properties:
        action:
          type: string
        async:
          type: boolean
        server:
          type: string
        success:
          type: boolean
      type: object
    contracts.ServerStats:
      properties:
        connected_servers:
          type: integer
        docker_containers:
          type: integer
        quarantined_servers:
          type: integer
        token_metrics:
          $ref: '#/components/schemas/contracts.ServerTokenMetrics'
        total_servers:
          type: integer
        total_tools:
          type: integer
      type: object
    contracts.ServerTokenMetrics:
      properties:
        average_query_result_size:
          description: Typical retrieve_tools output (tokens)
          type: integer
        per_server_tool_list_sizes:
          additionalProperties:
            type: integer
          description: Token size per server
          type: object
        saved_tokens:
          description: Difference
          type: integer
        saved_tokens_percentage:
          description: Percentage saved
          type: number
        total_server_tool_list_size:
          description: All upstream tools combined (tokens)
          type: integer
      type: object
    contracts.SuccessResponse:
      properties:
        data: {}
        success:
          type: boolean
      type: object
    contracts.TokenMetrics:
      description: Token usage metrics (nil for older records)
      properties:
        encoding:
          description: Encoding used (e.g., cl100k_base)
          type: string
        estimated_cost:
          description: Optional cost estimate
          type: number
        input_tokens:
          description: Tokens in the request
          type: integer
        model:
          description: Model used for tokenization
          type: string
        output_tokens:
          description: Tokens in the response
          type: integer
        total_tokens:
          description: Total tokens (input + output)
          type: integer
        truncated_tokens:
          description: Tokens removed by truncation
          type: integer
        was_truncated:
          description: Whether response was truncated
          type: boolean
      type: object
    contracts.Tool:
      properties:
        annotations:
          $ref: '#/components/schemas/contracts.ToolAnnotation'
        description:
          type: string
        last_used:
          type: string
        name:
          type: string
        schema:
          additionalProperties: {}
          type: object
        server_name:
          type: string
        usage:
          type: integer
      type: object
    contracts.ToolAnnotation:
      description: Tool behavior hints snapshot
      properties:
        destructiveHint:
          type: boolean
        idempotentHint:
          type: boolean
        openWorldHint:
          type: boolean
        readOnlyHint:
          type: boolean
        title:
          type: string
      type: object
    contracts.ToolCallRecord:
      description: The new tool call record
      properties:
        annotations:
          $ref: '#/components/schemas/contracts.ToolAnnotation'
        arguments:
          additionalProperties: {}
          description: Tool arguments
          type: object
        config_path:
          description: Active config file path
          type: string
        duration:
          description: Duration in nanoseconds
          type: integer
        error:
          description: Error message (failure only)
          type: string
        execution_type:
          description: '"direct" or "code_execution"'
          type: string
        id:
          description: Unique identifier
          type: string
        mcp_client_name:
          description: MCP client name from InitializeRequest
          type: string
        mcp_client_version:
          description: MCP client version
          type: string
        mcp_session_id:
          description: MCP session identifier
          type: string
        metrics:
          $ref: '#/components/schemas/contracts.TokenMetrics'
        parent_call_id:
          description: Links nested calls to parent code_execution
          type: string
        request_id:
          description: Request correlation ID
          type: string
        response:
          description: Tool response (success only)
        server_id:
          description: Server identity hash
          type: string
        server_name:
          description: Human-readable server name
          type: string
        timestamp:
          description: When the call was made
          type: string
        tool_name:
          description: Tool name (without server prefix)
          type: string
      type: object
    contracts.UpstreamError:
      properties:
        error_message:
          type: string
        server_name:
          type: string
        timestamp:
          type: string
      type: object
    contracts.ValidateConfigResponse:
      properties:
        errors:
          items:
            $ref: '#/components/schemas/contracts.ValidationError'
          type: array
          uniqueItems: false
        valid:
          type: boolean
      type: object
    contracts.ValidationError:
      properties:
        field:
          type: string
        message:
          type: string
      type: object
    main.Diagnostics:
      properties:
        docker_status:
          $ref: '#/components/schemas/main.DockerStatus'
        missing_secrets:
          items:
            $ref: '#/components/schemas/main.MissingSecret'
          type: array
          uniqueItems: false
        oauth_required:
          items:
            $ref: '#/components/schemas/main.OAuthRequirement'
          type: array
          uniqueItems: false
        runtime_warnings:
          items:
            type: string
          type: array
          uniqueItems: false
        timestamp:
          example: "2025-11-23T10:35:12Z"
          type: string
        total_issues:
          example: 3
          type: integer
        upstream_errors:
          items:
            $ref: '#/components/schemas/main.UpstreamError'
          type: array
          uniqueItems: false
      type: object
    main.DockerStatus:
      properties:
        available:
          example: true
          type: boolean
        error:
          example: ""
          type: string
        version:
          example: 24.0.7
          type: string
      type: object
    main.ErrorResponse:
      properties:
        code:
          example: MGMT_DISABLED
          type: string
        details:
          example: Set disable_management=false in config
          type: string
        error:
          example: management operations disabled
          type: string
      type: object
    main.LogEntry:
      properties:
        level:
          example: INFO
          type: string
        message:
          example: 'Tool call: create_issue'
          type: string
        server:
          example: github-server
          type: string
        timestamp:
          example: "2025-11-23T10:30:00Z"
          type: string
      type: object
    main.MissingSecret:
      properties:
        secret_name:
          example: GITHUB_TOKEN
          type: string
        used_by:
          example:
          - '["github-server"'
          - '"gh-issues"]'
          items:
            type: string
          type: array
          uniqueItems: false
      type: object
    main.OAuthRequirement:
      properties:
        expires_at:
          example: "2025-11-22T18:00:00Z"
          type: string
        message:
          example: 'Run: mcpproxy auth login --server=github-server'
          type: string
        server_name:
          example: github-server
          type: string
        state:
          example: expired
          type: string
      type: object
    main.RestartAllResponse:
      properties:
        errors:
          example:
          - '["server-1: connection timeout"]'
          items:
            type: string
          type: array
          uniqueItems: false
        failed_count:
          example: 1
          type: integer
        success_count:
          example: 9
          type: integer
      type: object
    main.Server:
      properties:
        connected:
          example: true
          type: boolean
        enabled:
          example: true
          type: boolean
        error:
          example: ""
          type: string
        name:
          example: github-server
          type: string
        quarantined:
          example: false
          type: boolean
        tool_count:
          example: 25
          type: integer
      type: object
    main.ServerStats:
      properties:
        connected:
          example: 7
          type: integer
        disabled:
          example: 2
          type: integer
        enabled:
          example: 8
          type: integer
        errors:
          example: 1
          type: integer
        quarantined:
          example: 1
          type: integer
        total:
          example: 10
          type: integer
      type: object
    main.ServersResponse:
      properties:
        servers:
          items:
            $ref: '#/components/schemas/main.Server'
          type: array
          uniqueItems: false
        stats:
          $ref: '#/components/schemas/main.ServerStats'
      type: object
    main.UpstreamError:
      properties:
        error_message:
          example: connection refused
          type: string
        server_name:
          example: weather-api
          type: string
        timestamp:
          example: "2025-11-23T09:15:30Z"
          type: string
      type: object
    management.BulkOperationResult:
      properties:
        errors:
          additionalProperties:
            type: string
          description: Map of server name to error message
          type: object
        failed:
          description: Number of failed operations
          type: integer
        successful:
          description: Number of successful operations
          type: integer
        total:
          description: Total servers processed
          type: integer
      type: object
  securitySchemes:
    ApiKeyAuth:
      description: API key authentication via query parameter. Use ?apikey=your-key
      in: query
      name: apikey
      type: apiKey
externalDocs:
  description: ""
  url: ""
info:
  contact:
    name: MCPProxy Support
    url: https://github.com/smart-mcp-proxy/mcpproxy-go
  description: |-
    MCPProxy REST API for managing MCP servers, tools, and diagnostics

    MCPProxy is a smart proxy for AI agents using the Model Context Protocol (MCP).
    It provides intelligent tool discovery, massive token savings, and built-in security quarantine.
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  title: MCPProxy API
  version: "1.0"
openapi: 3.1.0
paths:
  /api/v1/config:
    get:
      description: Retrieves the current MCPProxy configuration including all server
        definitions, global settings, and runtime parameters
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.GetConfigResponse'
          description: Configuration retrieved successfully
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Failed to get configuration
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get current configuration
      tags:
      - config
  /api/v1/config/apply:
    post:
      description: Applies a new MCPProxy configuration. Validates and persists the
        configuration to disk. Some changes apply immediately, while others may require
        a restart. Returns detailed information about applied changes and restart
        requirements.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/config.Config'
        description: Configuration to apply
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ConfigApplyResult'
          description: Configuration applied successfully with change details
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Invalid JSON payload
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Failed to apply configuration
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Apply configuration
      tags:
      - config
  /api/v1/config/validate:
    post:
      description: Validates a provided MCPProxy configuration without applying it.
        Checks for syntax errors, invalid server definitions, conflicting settings,
        and other configuration issues.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/config.Config'
        description: Configuration to validate
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ValidateConfigResponse'
          description: Configuration validation result
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Invalid JSON payload
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Validation failed
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Validate configuration
      tags:
      - config
  /api/v1/registries:
    get:
      description: Retrieves list of all MCP server registries that can be browsed
        for discovering and installing new upstream servers. Includes registry metadata,
        server counts, and API endpoints.
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.GetRegistriesResponse'
          description: Registries retrieved successfully
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Failed to list registries
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: List available MCP server registries
      tags:
      - registries
  /api/v1/registries/{id}/servers:
    get:
      description: Searches for MCP servers within a specific registry by keyword
        or tag. Returns server metadata including installation commands, source code
        URLs, and npm package information for easy discovery and installation.
      parameters:
      - description: Registry ID
        in: path
        name: id
        required: true
        schema:
          type: string
      - description: Search query keyword
        in: query
        name: q
        schema:
          type: string
      - description: Filter by tag
        in: query
        name: tag
        schema:
          type: string
      - description: Maximum number of results (default 10)
        in: query
        name: limit
        schema:
          type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.SearchRegistryServersResponse'
          description: Servers retrieved successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Registry ID required
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Failed to search servers
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Search MCP servers in a registry
      tags:
      - registries
  /api/v1/secrets:
    post:
      description: Stores a secret value in the operating system's secure keyring.
        The secret can then be referenced in configuration using ${keyring:secret-name}
        syntax. Automatically notifies runtime to restart affected servers.
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                additionalProperties: {}
                type: object
          description: Secret stored successfully with reference syntax
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Invalid JSON payload, missing name/value, or unsupported type
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "405":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Method not allowed
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Secret resolver not available or failed to store secret
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Store a secret in OS keyring
      tags:
      - secrets
  /api/v1/secrets/{name}:
    delete:
      description: Deletes a secret from the operating system's secure keyring. Automatically
        notifies runtime to restart affected servers. Only keyring type is supported
        for security.
      parameters:
      - description: Name of the secret to delete
        in: path
        name: name
        required: true
        schema:
          type: string
      - description: Secret type (only 'keyring' supported, defaults to 'keyring')
        in: query
        name: type
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                additionalProperties: {}
                type: object
          description: Secret deleted successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Missing secret name or unsupported type
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "405":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Method not allowed
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Secret resolver not available or failed to delete secret
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Delete a secret from OS keyring
      tags:
      - secrets
  /api/v1/servers/{id}/tool-calls:
    get:
      description: Retrieves tool call history filtered by upstream server ID. Returns
        recent tool executions for the specified server including timestamps, arguments,
        results, and errors. Useful for server-specific debugging and monitoring.
      parameters:
      - description: Upstream server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      - description: Maximum number of records to return (1-100, default 50)
        in: query
        name: limit
        schema:
          type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.GetServerToolCallsResponse'
          description: Server tool calls retrieved successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server ID required
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "405":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Method not allowed
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Failed to get server tool calls
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get tool call history for specific server
      tags:
      - tool-calls
  /api/v1/sessions:
    get:
      description: Retrieves paginated list of active and recent MCP client sessions.
        Each session represents a connection from an MCP client to MCPProxy, tracking
        initialization time, tool calls, and connection status.
      parameters:
      - description: Maximum number of sessions to return (1-100, default 10)
        in: query
        name: limit
        schema:
          type: integer
      - description: Number of sessions to skip for pagination (default 0)
        in: query
        name: offset
        schema:
          type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.GetSessionsResponse'
          description: Sessions retrieved successfully
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "405":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Method not allowed
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Failed to get sessions
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get active MCP sessions
      tags:
      - sessions
  /api/v1/sessions/{id}:
    get:
      description: Retrieves detailed information about a specific MCP client session
        including initialization parameters, connection status, tool call count, and
        activity timestamps.
      parameters:
      - description: Session ID
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.GetSessionDetailResponse'
          description: Session details retrieved successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Session ID required
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Session not found
        "405":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Method not allowed
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get MCP session details by ID
      tags:
      - sessions
  /api/v1/tool-calls:
    get:
      description: Retrieves paginated tool call history across all upstream servers
        or filtered by session ID. Includes execution timestamps, arguments, results,
        and error information for debugging and auditing.
      parameters:
      - description: Maximum number of records to return (1-100, default 50)
        in: query
        name: limit
        schema:
          type: integer
      - description: Number of records to skip for pagination (default 0)
        in: query
        name: offset
        schema:
          type: integer
      - description: Filter tool calls by MCP session ID
        in: query
        name: session_id
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.GetToolCallsResponse'
          description: Tool calls retrieved successfully
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "405":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Method not allowed
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Failed to get tool calls
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get tool call history
      tags:
      - tool-calls
  /api/v1/tool-calls/{id}:
    get:
      description: Retrieves detailed information about a specific tool call execution
        including full request arguments, response data, execution time, and any errors
        encountered.
      parameters:
      - description: Tool call ID
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.GetToolCallDetailResponse'
          description: Tool call details retrieved successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Tool call ID required
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Tool call not found
        "405":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Method not allowed
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get tool call details by ID
      tags:
      - tool-calls
  /api/v1/tool-calls/{id}/replay:
    post:
      description: Re-executes a previous tool call with optional modified arguments.
        Useful for debugging and testing tool behavior with different inputs. Creates
        a new tool call record linked to the original.
      parameters:
      - description: Original tool call ID to replay
        in: path
        name: id
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/contracts.ReplayToolCallRequest'
        description: Optional modified arguments for replay
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ReplayToolCallResponse'
          description: Tool call replayed successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Tool call ID required or invalid JSON payload
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "405":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Method not allowed
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Failed to replay tool call
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Replay a tool call
      tags:
      - tool-calls
  /diagnostics:
    get:
      description: Get comprehensive health diagnostics including upstream errors,
        OAuth requirements, missing secrets, and Docker status
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.Diagnostics'
          description: Health diagnostics
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get health diagnostics
      tags:
      - diagnostics
  /docker/status:
    get:
      description: Retrieve current Docker availability and recovery status
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.SuccessResponse'
          description: Docker status information
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get Docker status
      tags:
      - docker
  /doctor:
    get:
      description: Aggregates health information from all servers, checks OAuth status,
        missing secrets, and Docker availability
      parameters:
      - description: API Key
        in: query
        name: apikey
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.Diagnostics'
          description: Comprehensive health diagnostics
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Unauthorized
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
        ApiKeyQuery: []
      summary: Run health diagnostics
      tags:
      - diagnostics
  /index/search:
    get:
      description: Search across all upstream MCP server tools using BM25 keyword
        search
      parameters:
      - description: Search query
        in: query
        name: q
        required: true
        schema:
          type: string
      - description: Maximum number of results
        in: query
        name: limit
        schema:
          default: 10
          maximum: 100
          type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.SearchToolsResponse'
          description: Search results
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request (missing query parameter)
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Search for tools
      tags:
      - tools
  /info:
    get:
      description: |-
        Get essential server metadata including version, web UI URL, and endpoint addresses
        This endpoint is designed for tray-core communication
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.SuccessResponse'
          description: Server information
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get server information
      tags:
      - status
  /servers:
    get:
      description: Returns all configured MCP servers with connection status, tool
        counts, and aggregate statistics
      parameters:
      - description: API Key (alternative to header for browser/SSE)
        in: query
        name: apikey
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ServersResponse'
          description: List of servers with statistics
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
        ApiKeyQuery: []
      summary: List all upstream servers
      tags:
      - servers
  /servers/{id}/disable:
    post:
      description: Disable a specific upstream MCP server
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ServerActionResponse'
          description: Server disabled successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Disable an upstream server
      tags:
      - servers
  /servers/{id}/enable:
    post:
      description: Enable a specific upstream MCP server
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ServerActionResponse'
          description: Server enabled successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Enable an upstream server
      tags:
      - servers
  /servers/{id}/login:
    post:
      description: Initiate OAuth authentication flow for a specific upstream MCP
        server
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ServerActionResponse'
          description: OAuth login initiated successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request (missing server ID)
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Trigger OAuth login for server
      tags:
      - servers
  /servers/{id}/logs:
    get:
      description: Retrieve log entries for a specific upstream MCP server
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      - description: Number of log lines to retrieve
        in: query
        name: tail
        schema:
          default: 100
          type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.GetServerLogsResponse'
          description: Server logs retrieved successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request (missing server ID)
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get server logs
      tags:
      - servers
  /servers/{id}/quarantine:
    post:
      description: Place a specific upstream MCP server in quarantine to prevent tool
        execution
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ServerActionResponse'
          description: Server quarantined successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request (missing server ID)
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Quarantine a server
      tags:
      - servers
  /servers/{id}/restart:
    post:
      description: Restart the connection to a specific upstream MCP server
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ServerActionResponse'
          description: Server restarted successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Restart an upstream server
      tags:
      - servers
  /servers/{id}/tools:
    get:
      description: Retrieve all available tools for a specific upstream MCP server
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.GetServerToolsResponse'
          description: Server tools retrieved successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request (missing server ID)
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get tools for a server
      tags:
      - servers
  /servers/{id}/unquarantine:
    post:
      description: Remove a specific upstream MCP server from quarantine to allow
        tool execution
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ServerActionResponse'
          description: Server unquarantined successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request (missing server ID)
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Unquarantine a server
      tags:
      - servers
  /servers/{name}/logs:
    get:
      description: Returns recent log entries for a specific upstream server
      parameters:
      - description: Server name
        in: path
        name: name
        required: true
        schema:
          type: string
      - description: Number of lines to return (default 50, max 1000)
        in: query
        name: tail
        schema:
          type: integer
      - description: API Key
        in: query
        name: apikey
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/main.LogEntry'
                type: array
          description: Log entries
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Bad request - invalid tail parameter
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Unauthorized
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
        ApiKeyQuery: []
      summary: Get server logs
      tags:
      - servers
  /servers/{name}/restart:
    post:
      description: Stops and restarts the connection to a specific upstream MCP server.
        Emits servers.changed event.
      parameters:
      - description: Server name
        in: path
        name: name
        required: true
        schema:
          type: string
      - description: API Key (alternative to header)
        in: query
        name: apikey
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                additionalProperties:
                  type: string
                type: object
          description: Success message
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Bad request - invalid server name
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Forbidden - read-only mode or management disabled
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
        ApiKeyQuery: []
      summary: Restart an upstream server
      tags:
      - servers
  /servers/disable_all:
    post:
      description: Disable all configured upstream MCP servers with partial failure
        handling
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/management.BulkOperationResult'
          description: Bulk disable results with success/failure counts
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Forbidden (management disabled)
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Disable all servers
      tags:
      - servers
  /servers/enable_all:
    post:
      description: Enable all configured upstream MCP servers with partial failure
        handling
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/management.BulkOperationResult'
          description: Bulk enable results with success/failure counts
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Forbidden (management disabled)
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Enable all servers
      tags:
      - servers
  /servers/reconnect:
    post:
      description: Force reconnection to all upstream MCP servers
      parameters:
      - description: Reason for reconnection
        in: query
        name: reason
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ServerActionResponse'
          description: All servers reconnected successfully
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Reconnect all servers
      tags:
      - servers
  /servers/restart_all:
    post:
      description: Sequentially restarts all configured servers. Returns partial success
        if some servers fail.
      parameters:
      - description: API Key
        in: query
        name: apikey
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.RestartAllResponse'
          description: Restart results with success/failure counts
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Forbidden - read-only mode
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
        ApiKeyQuery: []
      summary: Restart all upstream servers
      tags:
      - servers
  /stats/tokens:
    get:
      description: Retrieve token savings statistics across all servers and sessions
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.SuccessResponse'
          description: Token statistics
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get token savings statistics
      tags:
      - stats
  /status:
    get:
      description: Get comprehensive server status including running state, listen
        address, upstream statistics, and timestamp
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.SuccessResponse'
          description: Server status information
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get server status
      tags:
      - status
  /tools/call:
    post:
      description: Execute a tool on an upstream MCP server (wrapper around MCP tool
        calls)
      requestBody:
        content:
          application/json:
            schema:
              properties:
                arguments:
                  type: object
                tool_name:
                  type: string
              type: object
        description: Tool call request with tool name and arguments
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.SuccessResponse'
          description: Tool call result
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request (invalid payload or missing tool name)
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error or tool execution failure
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Call a tool
      tags:
      - tools
