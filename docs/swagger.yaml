components:
  schemas:
    contracts.Diagnostics:
      properties:
        docker_status:
          $ref: '#/components/schemas/contracts.DockerStatus'
        missing_secrets:
          description: Renamed to avoid conflict
          items:
            $ref: '#/components/schemas/contracts.MissingSecretInfo'
          type: array
          uniqueItems: false
        oauth_required:
          items:
            $ref: '#/components/schemas/contracts.OAuthRequirement'
          type: array
          uniqueItems: false
        runtime_warnings:
          items:
            type: string
          type: array
          uniqueItems: false
        timestamp:
          type: string
        total_issues:
          type: integer
        upstream_errors:
          items:
            $ref: '#/components/schemas/contracts.UpstreamError'
          type: array
          uniqueItems: false
      type: object
    contracts.DockerStatus:
      properties:
        available:
          type: boolean
        error:
          type: string
        version:
          type: string
      type: object
    contracts.ErrorResponse:
      properties:
        error:
          type: string
        success:
          type: boolean
      type: object
    contracts.GetServerLogsResponse:
      properties:
        count:
          type: integer
        logs:
          items:
            $ref: '#/components/schemas/contracts.LogEntry'
          type: array
          uniqueItems: false
        server_name:
          type: string
      type: object
    contracts.GetServerToolsResponse:
      properties:
        count:
          type: integer
        server_name:
          type: string
        tools:
          items:
            $ref: '#/components/schemas/contracts.Tool'
          type: array
          uniqueItems: false
      type: object
    contracts.GetServersResponse:
      properties:
        servers:
          items:
            $ref: '#/components/schemas/contracts.Server'
          type: array
          uniqueItems: false
        stats:
          $ref: '#/components/schemas/contracts.ServerStats'
      type: object
    contracts.IsolationConfig:
      properties:
        cpu_limit:
          type: string
        enabled:
          type: boolean
        image:
          type: string
        memory_limit:
          type: string
        timeout:
          type: string
        working_dir:
          type: string
      type: object
    contracts.LogEntry:
      properties:
        fields:
          additionalProperties: {}
          type: object
        level:
          type: string
        message:
          type: string
        server:
          type: string
        timestamp:
          type: string
      type: object
    contracts.MissingSecretInfo:
      properties:
        secret_name:
          type: string
        used_by:
          items:
            type: string
          type: array
          uniqueItems: false
      type: object
    contracts.OAuthConfig:
      properties:
        auth_url:
          type: string
        client_id:
          type: string
        extra_params:
          additionalProperties:
            type: string
          type: object
        redirect_port:
          type: integer
        scopes:
          items:
            type: string
          type: array
          uniqueItems: false
        token_url:
          type: string
      type: object
    contracts.OAuthRequirement:
      properties:
        expires_at:
          type: string
        message:
          type: string
        server_name:
          type: string
        state:
          type: string
      type: object
    contracts.SearchResult:
      properties:
        matches:
          type: integer
        score:
          type: number
        snippet:
          type: string
        tool:
          $ref: '#/components/schemas/contracts.Tool'
      type: object
    contracts.SearchToolsResponse:
      properties:
        query:
          type: string
        results:
          items:
            $ref: '#/components/schemas/contracts.SearchResult'
          type: array
          uniqueItems: false
        took:
          type: string
        total:
          type: integer
      type: object
    contracts.Server:
      properties:
        args:
          items:
            type: string
          type: array
          uniqueItems: false
        authenticated:
          description: OAuth authentication status
          type: boolean
        command:
          type: string
        connected:
          type: boolean
        connected_at:
          type: string
        created:
          type: string
        enabled:
          type: boolean
        env:
          additionalProperties:
            type: string
          type: object
        headers:
          additionalProperties:
            type: string
          type: object
        id:
          type: string
        isolation:
          $ref: '#/components/schemas/contracts.IsolationConfig'
        last_error:
          type: string
        last_reconnect_at:
          type: string
        last_retry_time:
          type: string
        name:
          type: string
        oauth:
          $ref: '#/components/schemas/contracts.OAuthConfig'
        protocol:
          type: string
        quarantined:
          type: boolean
        reconnect_count:
          type: integer
        retry_count:
          type: integer
        should_retry:
          type: boolean
        status:
          type: string
        tool_count:
          type: integer
        tool_list_token_size:
          description: Token size for this server's tools
          type: integer
        updated:
          type: string
        url:
          type: string
        working_dir:
          type: string
      type: object
    contracts.ServerActionResponse:
      properties:
        action:
          type: string
        async:
          type: boolean
        server:
          type: string
        success:
          type: boolean
      type: object
    contracts.ServerStats:
      properties:
        connected_servers:
          type: integer
        docker_containers:
          type: integer
        quarantined_servers:
          type: integer
        token_metrics:
          $ref: '#/components/schemas/contracts.ServerTokenMetrics'
        total_servers:
          type: integer
        total_tools:
          type: integer
      type: object
    contracts.ServerTokenMetrics:
      properties:
        average_query_result_size:
          description: Typical retrieve_tools output (tokens)
          type: integer
        per_server_tool_list_sizes:
          additionalProperties:
            type: integer
          description: Token size per server
          type: object
        saved_tokens:
          description: Difference
          type: integer
        saved_tokens_percentage:
          description: Percentage saved
          type: number
        total_server_tool_list_size:
          description: All upstream tools combined (tokens)
          type: integer
      type: object
    contracts.SuccessResponse:
      properties:
        data: {}
        success:
          type: boolean
      type: object
    contracts.Tool:
      properties:
        annotations:
          $ref: '#/components/schemas/contracts.ToolAnnotation'
        description:
          type: string
        last_used:
          type: string
        name:
          type: string
        schema:
          additionalProperties: {}
          type: object
        server_name:
          type: string
        usage:
          type: integer
      type: object
    contracts.ToolAnnotation:
      properties:
        destructiveHint:
          type: boolean
        idempotentHint:
          type: boolean
        openWorldHint:
          type: boolean
        readOnlyHint:
          type: boolean
        title:
          type: string
      type: object
    contracts.UpstreamError:
      properties:
        error_message:
          type: string
        server_name:
          type: string
        timestamp:
          type: string
      type: object
    main.Diagnostics:
      properties:
        docker_status:
          $ref: '#/components/schemas/main.DockerStatus'
        missing_secrets:
          items:
            $ref: '#/components/schemas/main.MissingSecret'
          type: array
          uniqueItems: false
        oauth_required:
          items:
            $ref: '#/components/schemas/main.OAuthRequirement'
          type: array
          uniqueItems: false
        runtime_warnings:
          items:
            type: string
          type: array
          uniqueItems: false
        timestamp:
          example: "2025-11-23T10:35:12Z"
          type: string
        total_issues:
          example: 3
          type: integer
        upstream_errors:
          items:
            $ref: '#/components/schemas/main.UpstreamError'
          type: array
          uniqueItems: false
      type: object
    main.DockerStatus:
      properties:
        available:
          example: true
          type: boolean
        error:
          example: ""
          type: string
        version:
          example: 24.0.7
          type: string
      type: object
    main.ErrorResponse:
      properties:
        code:
          example: MGMT_DISABLED
          type: string
        details:
          example: Set disable_management=false in config
          type: string
        error:
          example: management operations disabled
          type: string
      type: object
    main.LogEntry:
      properties:
        level:
          example: INFO
          type: string
        message:
          example: 'Tool call: create_issue'
          type: string
        server:
          example: github-server
          type: string
        timestamp:
          example: "2025-11-23T10:30:00Z"
          type: string
      type: object
    main.MissingSecret:
      properties:
        secret_name:
          example: GITHUB_TOKEN
          type: string
        used_by:
          example:
          - '["github-server"'
          - '"gh-issues"]'
          items:
            type: string
          type: array
          uniqueItems: false
      type: object
    main.OAuthRequirement:
      properties:
        expires_at:
          example: "2025-11-22T18:00:00Z"
          type: string
        message:
          example: 'Run: mcpproxy auth login --server=github-server'
          type: string
        server_name:
          example: github-server
          type: string
        state:
          example: expired
          type: string
      type: object
    main.RestartAllResponse:
      properties:
        errors:
          example:
          - '["server-1: connection timeout"]'
          items:
            type: string
          type: array
          uniqueItems: false
        failed_count:
          example: 1
          type: integer
        success_count:
          example: 9
          type: integer
      type: object
    main.Server:
      properties:
        connected:
          example: true
          type: boolean
        enabled:
          example: true
          type: boolean
        error:
          example: ""
          type: string
        name:
          example: github-server
          type: string
        quarantined:
          example: false
          type: boolean
        tool_count:
          example: 25
          type: integer
      type: object
    main.ServerStats:
      properties:
        connected:
          example: 7
          type: integer
        disabled:
          example: 2
          type: integer
        enabled:
          example: 8
          type: integer
        errors:
          example: 1
          type: integer
        quarantined:
          example: 1
          type: integer
        total:
          example: 10
          type: integer
      type: object
    main.ServersResponse:
      properties:
        servers:
          items:
            $ref: '#/components/schemas/main.Server'
          type: array
          uniqueItems: false
        stats:
          $ref: '#/components/schemas/main.ServerStats'
      type: object
    main.UpstreamError:
      properties:
        error_message:
          example: connection refused
          type: string
        server_name:
          example: weather-api
          type: string
        timestamp:
          example: "2025-11-23T09:15:30Z"
          type: string
      type: object
    management.BulkOperationResult:
      properties:
        errors:
          additionalProperties:
            type: string
          description: Map of server name to error message
          type: object
        failed:
          description: Number of failed operations
          type: integer
        successful:
          description: Number of successful operations
          type: integer
        total:
          description: Total servers processed
          type: integer
      type: object
  securitySchemes:
    ApiKeyAuth:
      description: API key authentication via query parameter. Use ?apikey=your-key
      in: query
      name: apikey
      type: apiKey
externalDocs:
  description: ""
  url: ""
info:
  contact:
    name: MCPProxy Support
    url: https://github.com/smart-mcp-proxy/mcpproxy-go
  description: |-
    MCPProxy REST API for managing MCP servers, tools, and diagnostics

    MCPProxy is a smart proxy for AI agents using the Model Context Protocol (MCP).
    It provides intelligent tool discovery, massive token savings, and built-in security quarantine.
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  title: MCPProxy API
  version: "1.0"
openapi: 3.1.0
paths:
  /diagnostics:
    get:
      description: Get comprehensive health diagnostics including upstream errors,
        OAuth requirements, missing secrets, and Docker status
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.Diagnostics'
          description: Health diagnostics
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get health diagnostics
      tags:
      - diagnostics
  /docker/status:
    get:
      description: Retrieve current Docker availability and recovery status
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.SuccessResponse'
          description: Docker status information
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get Docker status
      tags:
      - docker
  /doctor:
    get:
      description: Aggregates health information from all servers, checks OAuth status,
        missing secrets, and Docker availability
      parameters:
      - description: API Key
        in: query
        name: apikey
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.Diagnostics'
          description: Comprehensive health diagnostics
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Unauthorized
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
        ApiKeyQuery: []
      summary: Run health diagnostics
      tags:
      - diagnostics
  /index/search:
    get:
      description: Search across all upstream MCP server tools using BM25 keyword
        search
      parameters:
      - description: Search query
        in: query
        name: q
        required: true
        schema:
          type: string
      - description: Maximum number of results
        in: query
        name: limit
        schema:
          default: 10
          maximum: 100
          type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.SearchToolsResponse'
          description: Search results
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request (missing query parameter)
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Search for tools
      tags:
      - tools
  /info:
    get:
      description: |-
        Get essential server metadata including version, web UI URL, and endpoint addresses
        This endpoint is designed for tray-core communication
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.SuccessResponse'
          description: Server information
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get server information
      tags:
      - status
  /servers:
    get:
      description: Returns all configured MCP servers with connection status, tool
        counts, and aggregate statistics
      parameters:
      - description: API Key (alternative to header for browser/SSE)
        in: query
        name: apikey
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ServersResponse'
          description: List of servers with statistics
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Unauthorized - missing or invalid API key
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
        ApiKeyQuery: []
      summary: List all upstream servers
      tags:
      - servers
  /servers/{id}/disable:
    post:
      description: Disable a specific upstream MCP server
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ServerActionResponse'
          description: Server disabled successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Disable an upstream server
      tags:
      - servers
  /servers/{id}/enable:
    post:
      description: Enable a specific upstream MCP server
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ServerActionResponse'
          description: Server enabled successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Enable an upstream server
      tags:
      - servers
  /servers/{id}/login:
    post:
      description: Initiate OAuth authentication flow for a specific upstream MCP
        server
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ServerActionResponse'
          description: OAuth login initiated successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request (missing server ID)
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Trigger OAuth login for server
      tags:
      - servers
  /servers/{id}/logs:
    get:
      description: Retrieve log entries for a specific upstream MCP server
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      - description: Number of log lines to retrieve
        in: query
        name: tail
        schema:
          default: 100
          type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.GetServerLogsResponse'
          description: Server logs retrieved successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request (missing server ID)
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get server logs
      tags:
      - servers
  /servers/{id}/quarantine:
    post:
      description: Place a specific upstream MCP server in quarantine to prevent tool
        execution
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ServerActionResponse'
          description: Server quarantined successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request (missing server ID)
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Quarantine a server
      tags:
      - servers
  /servers/{id}/restart:
    post:
      description: Restart the connection to a specific upstream MCP server
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ServerActionResponse'
          description: Server restarted successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Restart an upstream server
      tags:
      - servers
  /servers/{id}/tools:
    get:
      description: Retrieve all available tools for a specific upstream MCP server
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.GetServerToolsResponse'
          description: Server tools retrieved successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request (missing server ID)
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get tools for a server
      tags:
      - servers
  /servers/{id}/unquarantine:
    post:
      description: Remove a specific upstream MCP server from quarantine to allow
        tool execution
      parameters:
      - description: Server ID or name
        in: path
        name: id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ServerActionResponse'
          description: Server unquarantined successfully
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request (missing server ID)
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Unquarantine a server
      tags:
      - servers
  /servers/{name}/logs:
    get:
      description: Returns recent log entries for a specific upstream server
      parameters:
      - description: Server name
        in: path
        name: name
        required: true
        schema:
          type: string
      - description: Number of lines to return (default 50, max 1000)
        in: query
        name: tail
        schema:
          type: integer
      - description: API Key
        in: query
        name: apikey
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/main.LogEntry'
                type: array
          description: Log entries
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Bad request - invalid tail parameter
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Unauthorized
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
        ApiKeyQuery: []
      summary: Get server logs
      tags:
      - servers
  /servers/{name}/restart:
    post:
      description: Stops and restarts the connection to a specific upstream MCP server.
        Emits servers.changed event.
      parameters:
      - description: Server name
        in: path
        name: name
        required: true
        schema:
          type: string
      - description: API Key (alternative to header)
        in: query
        name: apikey
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                additionalProperties:
                  type: string
                type: object
          description: Success message
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Bad request - invalid server name
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Forbidden - read-only mode or management disabled
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Server not found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
        ApiKeyQuery: []
      summary: Restart an upstream server
      tags:
      - servers
  /servers/disable_all:
    post:
      description: Disable all configured upstream MCP servers with partial failure
        handling
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/management.BulkOperationResult'
          description: Bulk disable results with success/failure counts
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Forbidden (management disabled)
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Disable all servers
      tags:
      - servers
  /servers/enable_all:
    post:
      description: Enable all configured upstream MCP servers with partial failure
        handling
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/management.BulkOperationResult'
          description: Bulk enable results with success/failure counts
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Forbidden (management disabled)
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Enable all servers
      tags:
      - servers
  /servers/reconnect:
    post:
      description: Force reconnection to all upstream MCP servers
      parameters:
      - description: Reason for reconnection
        in: query
        name: reason
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ServerActionResponse'
          description: All servers reconnected successfully
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Reconnect all servers
      tags:
      - servers
  /servers/restart_all:
    post:
      description: Sequentially restarts all configured servers. Returns partial success
        if some servers fail.
      parameters:
      - description: API Key
        in: query
        name: apikey
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.RestartAllResponse'
          description: Restart results with success/failure counts
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Forbidden - read-only mode
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/main.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
        ApiKeyQuery: []
      summary: Restart all upstream servers
      tags:
      - servers
  /stats/tokens:
    get:
      description: Retrieve token savings statistics across all servers and sessions
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.SuccessResponse'
          description: Token statistics
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get token savings statistics
      tags:
      - stats
  /status:
    get:
      description: Get comprehensive server status including running state, listen
        address, upstream statistics, and timestamp
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.SuccessResponse'
          description: Server status information
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Get server status
      tags:
      - status
  /tools/call:
    post:
      description: Execute a tool on an upstream MCP server (wrapper around MCP tool
        calls)
      requestBody:
        content:
          application/json:
            schema:
              properties:
                arguments:
                  type: object
                tool_name:
                  type: string
              type: object
        description: Tool call request with tool name and arguments
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.SuccessResponse'
          description: Tool call result
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Bad request (invalid payload or missing tool name)
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/contracts.ErrorResponse'
          description: Internal server error or tool execution failure
      security:
      - ApiKeyAuth: []
      - ApiKeyQuery: []
      summary: Call a tool
      tags:
      - tools
servers:
- url: localhost:8080/api/v1
